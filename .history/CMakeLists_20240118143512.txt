# Minimum required CMake version
cmake_minimum_required(VERSION 3.20.2)

# Project name
project(meeting_sdk_linux_sample)

# Set C++ standard and compiler
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_COMPILER /usr/bin/g++)
set(CMAKE_BUILD_TYPE Debug)
set(CMAKE_SYSTEM_NAME Linux)
set(CMAKE_SYSTEM_PROCESSOR x86_64)

# External libraries
set(ZOOM_SDK lib/zoomsdk)
find_package(ada REQUIRED)
find_package(CLI11 REQUIRED)
find_package(Poco REQUIRED Foundation Net Util)
find_path(JWT_CPP_INCLUDE_DIRS "jwt-cpp/base.h")

# Find GLib using pkg-config
find_package(PkgConfig REQUIRED)
pkg_check_modules(deps REQUIRED IMPORTED_TARGET glib-2.0)

# Include directories
include_directories(
    ${ZOOM_SDK}/h
    ${Binn_INCLUDE_DIRS}
    ${Poco_INCLUDE_DIRS}
    ${JWT_CPP_INCLUDE_DIRS}
)

# Link directories
link_directories(
    ${ZOOM_SDK}
    ${ZOOM_SDK}/qt_libs
    ${ZOOM_SDK}/qt_libs/Qt/lib
)

# Project source files
add_executable(zoomsdk
    src/main.cpp
    src/Zoom.cpp
    src/Zoom.h
    src/Config.cpp
    src/Config.h
    src/util/Singleton.h
    src/util/Log.h
    src/events/AuthServiceEvent.cpp
    src/events/AuthServiceEvent.h
    src/events/MeetingServiceEvent.cpp
    src/events/MeetingServiceEvent.h
    src/events/MeetingReminderEvent.cpp
    src/events/MeetingReminderEvent.h
    src/events/MeetingRecordingCtrlEvent.cpp
    src/events/MeetingRecordingCtrlEvent.h
    src/raw-record/PocoHelper.cpp
    src/raw-record/PocoHelper.h
    src/raw-record/ZoomSDKAudioRawDataDelegate.cpp
    src/raw-record/ZoomSDKAudioRawDataDelegate.h
    src/raw-record/ZoomSDKRendererDelegate.cpp
    src/raw-record/ZoomSDKRendererDelegate.h
)

# Link libraries
target_link_libraries(zoomsdk PRIVATE
    Poco::Foundation
    Poco::Net
    Poco::Util
    meetingsdk
    ada::ada
    CLI11::CLI11
    PkgConfig::deps
)
